var GAME=GAME||{};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),GAME.app=function(){var a,b=window.innerHeight,c=window.innerWidth,d=10,e=[],f=$(".welcome-page"),g=$(".start-page"),h=function(){var d=document.getElementById("game-canvas");d.width=c,d.height=b,a=d.getContext("2d")},i=["https://cdn1.iconfinder.com/data/icons/winter_png/32/christmas_5.png","https://cdn3.iconfinder.com/data/icons/wpzoom-developer-icon-set/500/114-32.png","https://cdn1.iconfinder.com/data/icons/ie_Smashing_Christmas/32/christmas_35.png","https://cdn1.iconfinder.com/data/icons/Easter_lin/png/32x32/Ovo.png","https://cdn1.iconfinder.com/data/icons/desktop-halloween/32/Candy.png","https://cdn1.iconfinder.com/data/icons/iconshock_vista_CharlieandtheChocolateFactory/png/32/CharlieandtheChocolateFactory1.png","https://cdn1.iconfinder.com/data/icons/Birthday_iconfinder/32/lolly-strawberry.png","https://cdn1.iconfinder.com/data/icons/icon-set-32-px/32/Candy_Apple.png","https://cdn1.iconfinder.com/data/icons/CrystalClear/32x32/apps/icons.png","https://cdn1.iconfinder.com/data/icons/fatcow/32/candy_cane.png"],j=function(){this.item=new Image,this.item.src=i[r(i.length)],this.x=r(c),this.y=r(5),this.speed=3+r(5),this.caught=!1};j.prototype.dropItem=function(){};var k=function(){this.score=0,this.timer=30},l=function(){this.item=new Image,this.item.src="https://cdn1.iconfinder.com/data/icons/adidas/128/Shoebox_512x512.png",this.item.src2="https://cdn1.iconfinder.com/data/icons/windows-8-metro-style/128/tool_box.png",this.x=c/2,this.y=b-100,this.gamma=0},m=function(){window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(a){n.gamma=a.gamma},!1),window.DeviceOrientationEvent&&window.addEventListener("orientationchange",function(){90==window.orientation&&alert(" Landscape orientation not supported right now, Sorry !")},!1)},n=new l;m();var o=new k,p=function(){o.timer--,o.timer<0&&(alert("   You have Scored:"+o.score+"\n   Thank you for playing."),clearInterval(e.timer),clearInterval(e.gameItems),clearInterval(e.gameCatcher))},q=function(){this.objects=[],this.imgBg=new Image,this.imgBg.src="http://wallpoper.com/images/00/42/22/95/shapes-gradient_00422295.jpg";var f;this.drawBackground=function(){a.drawImage(imgBg,0,0)},this.drawGameInfo=function(){a.font="20px Georgia",a.fillText("Score",10,20),a.fillText(o.score,25,40),a.fillText("Timer",c-60,20),a.fillText(o.timer,c-45,40)},this.drawCatcher=function(){n.x>=0&&n.x<=c-120&&(n.x+=n.gamma,n.gamma=0,n.x<0?n.x=0:n.x>c-120&&(n.x=c-120)),a.drawImage(n.item,n.x,n.y)},this.draw=function(){this.drawBackground(),this.drawGameInfo(),this.drawCatcher();for(var e=0;d>e;e++)a.drawImage(objects[e].item,objects[e].x,objects[e].y),objects[e].y+=objects[e].speed,(objects[e].y>b||objects[e].caught)&&(objects[e].caught?o.score+=10:o.score-=5,objects[e].y=-25,objects[e].x=r(c)-25,objects[e].caught=!1),objects[e].y>b-120&&objects[e].x>n.x&&objects[e].x<n.x+200&&(objects[e].caught=!0)},this.load=function(){for(var a=0;d>a;a++)f=new j,this.objects.push(f);e.gameItems=setInterval(draw,36),e.timer=setInterval(p,1e3)},this.load()},r=function(a){return min=0,Math.floor(Math.random()*(a-min+1))+min};return{welcome:function(){var a=[],d=new FileReader,e=0;f.css("width",c).css("height",b),$(".welcome-page .btn").on("click",function(){f.hide(),g.fadeIn()}),g.css("width",c).css("height",b),$(".form-upload-image input").change(function(b){a[e]=b.target.files[e],d.readAsDataURL(a[0]),d.onload=function(a){e>0?($(".preview-img.mouth-closed").attr("src",a.target.result),$(".btn-start").fadeIn(),$(".btn-next").hide()):$(".preview-img.mouth-open").attr("src",a.target.result)},$(".btn-next").fadeIn().on("click",function(){$(this).hide(),$(".step-1").hide(),e++,$(".step-2").fadeIn()})}),$(".start-page .btn-upload").on("click",function(){$(".form-upload-image input").trigger("click")}),$(".start-page .btn-start").on("click",function(){g.fadeOut(),GAME.app.startGame()})},startGame:function(){h(),q()}}}(),$(".welcome-page").hide(),GAME.app.startGame();